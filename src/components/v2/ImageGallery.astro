---
import { X } from "@lucide/astro";
import { Image } from "astro:assets";

export interface Props {
  images: string[];
  title: string;
}

const { images, title } = Astro.props;
---

<div class="columns-1 sm:columns-2 md:columns-3 lg:columns-4 gap-6 px-3">
  {
    images.map((image, index) => {
      const popoverId = `image-popover-${index}`;
      return (
        <div class="break-inside-avoid mb-6 block">
          <button
            popovertarget={popoverId}
            class="w-full block cursor-pointer border-0 bg-transparent p-0"
          >
            <Image
              src={image}
              alt={`${title} ${index + 1}`}
              width={300}
              height={400}
              class="w-full block rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              loading="lazy"
            />
          </button>

          <div
            id={popoverId}
            popover="auto"
            class="bg-black/90 backdrop-blur-sm border-0 rounded-lg p-2 max-w-[95vw] max-h-[95vh] fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
          >
            <div class="relative">
              <button
                popovertarget={popoverId}
                popovertargetaction="hide"
                class="absolute top-2 right-2 bg-white/20 hover:bg-white/30 rounded-full p-2 transition-colors z-10 cursor-pointer"
              >
                <X class="w-6 h-6 text-white" />
              </button>
              <Image
                src={image}
                alt={`${title} ${index + 1}`}
                width={800}
                height={600}
                class="max-w-[93vw] max-h-[93vh] object-contain rounded-lg"
              />
            </div>
          </div>
        </div>
      );
    })
  }
</div>

